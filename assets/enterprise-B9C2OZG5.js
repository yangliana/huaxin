import{d as w,s as g,r as C,o as I,c as v,a as p,V as U,w as l,b as e,y as x,E as q,aC as D,z,g as F,h as m,l as G,G as N,F as O,H as T,u as y,q as L,k as R,x as W}from"./index-CgpHTJ9_.js";import{k as P,i as H,g as j}from"./admin-BidussuP.js";import{V as M}from"./VFileInput-DecipcqC.js";import{V as $}from"./VTextField-GMKXjoVd.js";import{V as B}from"./VForm-CUPs4Puc.js";import{V as A}from"./VAlert-BiziS-N9.js";import{r as J}from"./validate-BxfLMkoi.js";import{V as K,a as V,b as Q,c as h}from"./VTabs-CTX__IS6.js";import"./VField-CqBiyUiR.js";import"./VInput-uEpnQqPP.js";const X=w({__name:"name",setup(b){const n=g(null),d=g(null),a=g(null),o=C({loading:!1,currentIndex:0,records:[{name:"",logo:""},{name:"",logo:""}]}),s=()=>{o.loading=!0,a.value.validate().then(r=>{if(!r.valid)return Promise.reject(!1);var c=!1;return o.records.forEach(f=>{f.name&&(c=!0)}),c?P("enterprise",o.records):(y().show("至少需要填写一个企业全称",{color:"red"}),Promise.reject(!1))}).then(r=>{console.log(r),r.data&&r.data.code===200&&y().show("保存成功")}).finally(()=>{o.loading=!1})};function i(r){o.currentIndex=r,d.value.$el.querySelector('input[type="file"]').click()}const t=r=>new Promise((c,f)=>{const k=new FormData;k.append("image",r),H(k).then(_=>_.data.data).then(_=>{o.records[o.currentIndex].logo=_}).catch(_=>{console.error("Error:",_)})}),u=()=>{j("enterprise").then(r=>{r.data&&r.data.code===200&&(o.records=r.data.data)}).catch(r=>{console.error(r)})};return I(()=>{u()}),(r,c)=>(p(),v(U,{loading:o.loading,class:"py-5"},{default:l(()=>[e(B,{ref_key:"refForm",ref:a},{default:l(()=>[e(M,{ref_key:"refFileInput",ref:d,modelValue:q(n),"onUpdate:modelValue":[c[0]||(c[0]=f=>D(n)?n.value=f:null),t],accept:"image/*",class:"d-none"},null,8,["modelValue"]),(p(!0),x(O,null,z(o.records,(f,k)=>(p(),x("div",null,[e($,{modelValue:f.name,"onUpdate:modelValue":_=>f.name=_,label:"企业全称"},{prepend:l(()=>[f.logo?(p(),v(G,{key:0,src:f.logo,width:"32"},null,8,["src"])):(p(),v(N,{key:1,color:"grey",size:"32",icon:"mdi-image-broken-variant"}))]),"append-inner":l(()=>[e(F,{color:"primary",size:"small",variant:"plain",disabled:!f.name,onClick:_=>i(k)},{default:l(()=>c[1]||(c[1]=[m("上传LOGO")])),_:2,__:[1]},1032,["disabled","onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]))),256))]),_:1},512),e(T,null,{default:l(()=>[e(F,{loading:o.loading,variant:"elevated",color:"primary",onClick:s},{default:l(()=>c[2]||(c[2]=[m("保存")])),_:1,__:[2]},8,["loading"])]),_:1})]),_:1},8,["loading"]))}}),S=w({__name:"phone",props:["type","label"],setup(b){const n=b,d=g(null),a=C({loading:!1,records:[{phone:""},{phone:""},{phone:""},{phone:""}]}),o=t=>!t||/^[\d\-]{11,}$/.test(t)?!0:"手机/电话格式错误",s=()=>{a.loading=!0,d.value.validate().then(t=>{if(!t.valid)return Promise.reject(!1);var u=!1;return a.records.forEach(r=>{r.phone&&(u=!0)}),u?P(n.type,a.records):(y().show("至少需要填写一个电话",{color:"red"}),Promise.reject(!1))}).then(t=>{console.log(t),t.data&&t.data.code===200&&y().show("保存成功")}).finally(()=>{a.loading=!1})},i=()=>{j(n.type).then(t=>{if(t.data&&t.data.code===200){a.records=t.data.data;for(let u=a.records.length;u<4;++u)a.records.push({phone:""})}}).catch(t=>{console.error(t)})};return I(()=>{i()}),(t,u)=>(p(),v(U,{loading:a.loading,"max-width":"800"},{default:l(()=>[e(A,{icon:"mdi-information-variant-circle-outline",color:"blue",variant:"tonal",class:"my-3"},{default:l(()=>u[0]||(u[0]=[m(" 电话最多允许填写4个。至少填写1个。 ")])),_:1,__:[0]}),e(B,{ref_key:"refForm",ref:d},{default:l(()=>[(p(!0),x(O,null,z(a.records,(r,c)=>(p(),x("div",null,[e($,{modelValue:r.phone,"onUpdate:modelValue":f=>r.phone=f,"prepend-inner-icon":"mdi-cellphone",label:n.label?n.label:"热线电话",rules:[o]},null,8,["modelValue","onUpdate:modelValue","label","rules"])]))),256))]),_:1},512),e(T,null,{default:l(()=>[e(F,{loading:a.loading,variant:"elevated",color:"primary",onClick:s},{default:l(()=>u[1]||(u[1]=[m("保存")])),_:1,__:[1]},8,["loading"])]),_:1})]),_:1},8,["loading"]))}}),E="address",Y=w({__name:"address",setup(b){const n=g(null),d=C({loading:!1,records:[{address:""}]}),a=()=>{d.loading=!0,n.value.validate().then(s=>s.valid?P(E,d.records):Promise.reject(!1)).then(s=>{console.log(s),s.data&&s.data.code===200&&y().show("保存成功")}).finally(()=>{d.loading=!1})},o=()=>{j(E).then(s=>{if(s.data&&s.data.code===200){d.records=s.data.data;for(let i=d.records.length;i<1;++i)d.records.push({address:""})}}).catch(s=>{console.error(s)})};return I(()=>{o()}),(s,i)=>(p(),v(U,{loading:d.loading,"max-width":"800"},{default:l(()=>[e(A,{icon:"mdi-information-variant-circle-outline",color:"blue",variant:"tonal",class:"my-3"},{default:l(()=>i[1]||(i[1]=[m(" 请填写详细公司地址 ")])),_:1,__:[1]}),e(B,{ref_key:"refForm",ref:n},{default:l(()=>[e($,{modelValue:d.records[0].address,"onUpdate:modelValue":i[0]||(i[0]=t=>d.records[0].address=t),"prepend-inner-icon":"mdi-city",label:"公司地址",rules:[q(J).required]},null,8,["modelValue","rules"])]),_:1},512),e(T,null,{default:l(()=>[e(F,{loading:d.loading,variant:"elevated",color:"primary",onClick:a},{default:l(()=>i[2]||(i[2]=[m("保存")])),_:1,__:[2]},8,["loading"])]),_:1})]),_:1},8,["loading"]))}}),ie=w({__name:"enterprise",setup(b){g(null);const n=C({loading:!1,tab:"name"});return I(()=>{}),(d,a)=>(p(),v(U,{loading:n.loading},{default:l(()=>[e(L,{class:"bg-primary"},{default:l(()=>[e(N,{icon:"mdi-domain",size:"small"}),a[2]||(a[2]=m(" 企业信息 "))]),_:1,__:[2]}),e(R),e(W,null,{default:l(()=>[e(K,{modelValue:n.tab,"onUpdate:modelValue":a[0]||(a[0]=o=>n.tab=o)},{default:l(()=>[e(V,{value:"name",color:"red"},{default:l(()=>a[3]||(a[3]=[m("企业名称")])),_:1,__:[3]}),e(V,{value:"sale_phone",color:"orange"},{default:l(()=>a[4]||(a[4]=[m("销售电话")])),_:1,__:[4]}),e(V,{value:"service_phone",color:"blue"},{default:l(()=>a[5]||(a[5]=[m("客服电话")])),_:1,__:[5]}),e(V,{value:"tech_phone",color:"green"},{default:l(()=>a[6]||(a[6]=[m("技术电话")])),_:1,__:[6]}),e(V,{value:"address",color:"teal"},{default:l(()=>a[7]||(a[7]=[m("地址")])),_:1,__:[7]})]),_:1},8,["modelValue"]),e(Q,{modelValue:n.tab,"onUpdate:modelValue":a[1]||(a[1]=o=>n.tab=o)},{default:l(()=>[e(h,{value:"name"},{default:l(()=>[e(X)]),_:1}),e(h,{value:"sale_phone"},{default:l(()=>[e(S,{type:"sale_phone",label:"销售电话"})]),_:1}),e(h,{value:"service_phone"},{default:l(()=>[e(S,{type:"service_phone",label:"客服电话"})]),_:1}),e(h,{value:"tech_phone"},{default:l(()=>[e(S,{type:"tech_phone",label:"技术电话"})]),_:1}),e(h,{value:"address"},{default:l(()=>[e(Y)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["loading"]))}});export{ie as default};
