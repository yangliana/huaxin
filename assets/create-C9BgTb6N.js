import{_ as w}from"./editor.vue_vue_type_script_setup_true_lang-bLKUPE3b.js";import{d as x,s as l,C as h,r as k,o as C,c as b,a as T,w as o,b as t,q as S,v as A,h as u,g as B,x as D,i as f,e as c,E as p,V as E,u as F}from"./index-Dc9JgZ5a.js";import{r as g}from"./validate-BxfLMkoi.js";import{c as P,g as q}from"./admin-Dn8ru81H.js";import{_ as I,A as M}from"./images-BrKBPR1l.js";import{h as j}from"./moment-C5S46NFB.js";import{V as H}from"./VForm-_qL_3cmE.js";import{V as N}from"./VSelect-CWAQoyOf.js";import{V as R}from"./VTextField-C-kUFvZN.js";import"./quill.imageUploader-C3avU0UX.js";import"./VInput-HubAIwMk.js";import"./VCheckboxBtn-C2Ao_qol.js";import"./VSelectionControl-CNWnudf-.js";import"./uploadImage.vue_vue_type_script_setup_true_lang-DzvJfy5G.js";import"./VFileInput-CCw9KpUQ.js";import"./VField-BByKy3t6.js";import"./VHover-uTpBFiAi.js";const le=x({__name:"create",setup(U){const i=l(null),n=l(null),d=l(null),m=l(null),_=h(),e=k({loading:!1,categoryList:[],record:{id:0,title:"",category:"",attrs:[],images:[],cover:"",raw:null,html:"",createTime:j().format("yyyy-MM-DD HH:mm:ss")}}),V=()=>{e.loading=!0,i.value.validate().then(r=>r.valid?Promise.all([n.value.getData(),d.value.getData(),m.value.getContent()]):Promise.reject(!1)).then(r=>(e.record.attrs=r[0],e.record.images=r[1].images,e.record.cover=r[1].cover,e.record.raw=r[2].raw,e.record.html=r[2].html,P(e.record))).then(r=>{r.data&&r.data.code===200&&(F().show("保存成功"),setTimeout(()=>{_.push("/admin/product/list")},1500))}).finally(()=>{e.loading=!1})},y=()=>{e.loading=!0,q("product-category").then(r=>{r.data&&r.data.code===200&&(e.categoryList=r.data.data.map(a=>a.name))}).finally(()=>{e.loading=!1})};return C(()=>{y()}),(r,a)=>{const v=w;return T(),b(E,{loading:e.loading},{default:o(()=>[t(S,{class:"bg-green-lighten-1 py-1 d-flex justify-space-between"},{default:o(()=>[t(A,{variant:"text","prepend-icon":"mdi-star-plus-outline",size:"large"},{default:o(()=>a[2]||(a[2]=[u("创建产品")])),_:1,__:[2]}),t(B,{color:"pink",disabled:e.loading,onClick:V},{default:o(()=>a[3]||(a[3]=[u("发布")])),_:1,__:[3]},8,["disabled"])]),_:1}),t(D,{class:"pt-3"},{default:o(()=>[t(H,{ref_key:"refForm",ref:i},{default:o(()=>[t(f,{dense:""},{default:o(()=>[t(c,{cols:"6",xl:"3",lg:"3",md:"4",sm:"6"},{default:o(()=>[t(N,{modelValue:e.record.category,"onUpdate:modelValue":a[0]||(a[0]=s=>e.record.category=s),"prepend-inner-icon":"mdi-shape-outline",label:"产品分类",rules:[p(g).required],items:e.categoryList},null,8,["modelValue","rules","items"])]),_:1})]),_:1}),t(f,{dense:""},{default:o(()=>[t(c,{cols:"6",xl:"6",md:"6",sm:"12"},{default:o(()=>[t(R,{modelValue:e.record.title,"onUpdate:modelValue":a[1]||(a[1]=s=>e.record.title=s),"prepend-inner-icon":"mdi-rename-outline",label:"产品标题",rules:[p(g).required]},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(I,{ref_key:"refAttrs",ref:n},null,512),t(M,{ref_key:"refImages",ref:d},null,512),t(v,{ref_key:"refEditor",ref:m,raw:e.record.raw},null,8,["raw"])]),_:1},512)]),_:1})]),_:1},8,["loading"])}}});export{le as default};
