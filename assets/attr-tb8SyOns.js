import{U as K,a6 as Q,aW as B,bs as X,s as R,aN as Y,aP as F,bl as Z,af as ee,b8 as ae,b as a,I,F as T,a_ as te,c5 as le,G as z,bw as oe,c6 as se,d as ne,r as re,o as ie,c as A,a as y,w as r,q as de,h as f,j as C,x as ue,i as ce,y as me,z as fe,e as ve,H as Ve,g as he,V as ge,u as p}from"./index-Bf5RujO8.js";import{k as ke,g as be}from"./admin-DMXthsHm.js";import{V as we}from"./VAlert-DlmAAJ0C.js";import{V as _e}from"./VForm-BKyZDTFF.js";import{V as ye}from"./VTextField-Xl2DqYbc.js";import{a as Ce,V as U,m as pe}from"./VInput-Dsj5u6P7.js";import{V as N,m as xe}from"./VSelectionControl-DdSLpwtU.js";import"./VField-bkeYOBpv.js";const Se=Q({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...pe(),...xe()},"VSwitch"),Pe=K()({name:"VSwitch",inheritAttrs:!1,props:Se(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:indeterminate":e=>!0},setup(e,v){let{attrs:l,slots:s}=v;const u=B(e,"indeterminate"),t=B(e,"modelValue"),{loaderClasses:o}=X(e),{isFocused:n,focus:d,blur:c}=Ce(e),x=R(),S=Y&&window.matchMedia("(forced-colors: active)").matches,E=F(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),M=Z(),j=F(()=>e.id||`switch-${M}`);function D(){u.value&&(u.value=!1)}function L(V){var h,g;V.stopPropagation(),V.preventDefault(),(g=(h=x.value)==null?void 0:h.input)==null||g.click()}return ee(()=>{const[V,h]=ae(l),g=U.filterProps(e),O=N.filterProps(e);return a(U,I({class:["v-switch",{"v-switch--flat":e.flat},{"v-switch--inset":e.inset},{"v-switch--indeterminate":u.value},o.value,e.class]},V,g,{modelValue:t.value,"onUpdate:modelValue":k=>t.value=k,id:j.value,focused:n.value,style:e.style}),{...s,default:k=>{let{id:W,messagesId:q,isDisabled:G,isReadonly:H,isValid:P}=k;const b={model:t,isValid:P};return a(N,I({ref:x},O,{modelValue:t.value,"onUpdate:modelValue":[m=>t.value=m,D],id:W.value,"aria-describedby":q.value,type:"checkbox","aria-checked":u.value?"mixed":void 0,disabled:G.value,readonly:H.value,onFocus:d,onBlur:c},h),{...s,default:m=>{let{backgroundColorClasses:w,backgroundColorStyles:i}=m;return a("div",{class:["v-switch__track",S?void 0:w.value],style:i.value,onClick:L},[s["track-true"]&&a("div",{key:"prepend",class:"v-switch__track-true"},[s["track-true"](b)]),s["track-false"]&&a("div",{key:"append",class:"v-switch__track-false"},[s["track-false"](b)])])},input:m=>{let{inputNode:w,icon:i,backgroundColorClasses:$,backgroundColorStyles:J}=m;return a(T,null,[w,a("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":i||e.loading},e.inset||S?void 0:$.value],style:e.inset?void 0:J.value},[s.thumb?a(te,{defaults:{VIcon:{icon:i,size:"x-small"}}},{default:()=>[s.thumb({...b,icon:i})]}):a(le,null,{default:()=>[e.loading?a(oe,{name:"v-switch",active:!0,color:P.value===!1?void 0:E.value},{default:_=>s.loader?s.loader(_):a(se,{active:_.isActive,color:_.color,indeterminate:!0,size:"16",width:"2"},null)}):i&&a(z,{key:String(i),icon:i,size:"x-small"},null)]})])])}})}})}),{}}}),ze=ne({__name:"attr",setup(e){const v=R(null),l=re({loading:!1,type:"product-attr",maxCounts:8,records:[]}),s=()=>{l.loading=!0,v.value.validate().then(t=>{if(!t.valid)return Promise.reject(!1);var o=0,n={};return l.records.forEach(d=>{if(d.name){if(o+=1,n.hasOwnProperty(d.name))throw p().show(d.name+"已存在, 请调整属性名称",{color:"red"}),new Error("已存在");n[d.name]=!0}}),o<1?(p().show("至少设置1个属性",{color:"red"}),Promise.reject(!1)):ke(l.type,l.records)}).then(t=>{t.data&&t.data.code===200&&p().show("保存成功")}).finally(()=>{l.loading=!1})},u=()=>{be(l.type).then(t=>{if(t.data&&t.data.code===200){l.records=t.data.data;for(let o=l.records.length;o<l.maxCounts;++o)l.records.push({name:""})}}).catch(t=>{console.error(t)})};return ie(()=>{u()}),(t,o)=>(y(),A(ge,{loading:l.loading,"max-width":"1000"},{default:r(()=>[a(de,{class:"bg-info"},{default:r(()=>[a(z,{icon:"mdi-pound-box-outline",size:"small",class:"mr-1"}),o[0]||(o[0]=f(" 配置产品属性 "))]),_:1,__:[0]}),a(we,{class:"text-grey-darken-2 text-body-2",style:{"line-height":"1.8em"}},{default:r(()=>o[1]||(o[1]=[f(" 这里配置所有产品需要的公共属性词典"),C("br",null,null,-1),f(" 1. 属性类型分：必须属性，可选属性。"),C("br",null,null,-1),f(" 2. 必须属性每个产品都要填写，可选属性每个产品可选。"),C("br",null,null,-1)])),_:1,__:[1]}),a(ue,null,{default:r(()=>[a(_e,{ref_key:"refForm",ref:v},{default:r(()=>[a(ce,{dense:""},{default:r(()=>[(y(!0),me(T,null,fe(l.records,(n,d)=>(y(),A(ve,{cols:"4",lg:"4",md:"6",sm:"6",xs:"12"},{default:r(()=>[a(ye,{modelValue:n.name,"onUpdate:modelValue":c=>n.name=c,label:"属性名称",clearable:"",class:"d-inline-block w-50 mr-2","hide-details":""},null,8,["modelValue","onUpdate:modelValue"]),a(Pe,{modelValue:n.required,"onUpdate:modelValue":c=>n.required=c,label:n.required?"必须":"可选",color:"red",class:"d-inline-block","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),256))]),_:1})]),_:1},512)]),_:1}),a(Ve,null,{default:r(()=>[a(he,{loading:l.loading,variant:"elevated",color:"primary",onClick:s},{default:r(()=>o[2]||(o[2]=[f("保存")])),_:1,__:[2]},8,["loading"])]),_:1})]),_:1},8,["loading"]))}});export{ze as default};
