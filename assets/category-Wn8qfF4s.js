import{d as p,s as V,r as _,o as h,c as u,a as n,w as t,b as o,q as y,h as d,G as x,k as C,x as w,i as v,y as b,F as k,z as S,e as F,H as B,g as T,V as E,u as i}from"./index-5qLLyIeV.js";import{k as P,g as j}from"./admin-DLqVeSft.js";import{V as z}from"./VForm-BVR9RGWn.js";import{V as N}from"./VTextField-B4mZyLTN.js";import"./VInput-SPoS7vey.js";import"./VField-D1jQj0sG.js";const O=p({__name:"category",setup(U){const m=V(null),e=_({loading:!1,type:"product-category",maxCounts:9,records:[]}),c=()=>{e.loading=!0,m.value.validate().then(r=>{if(!r.valid)return Promise.reject(!1);var a=0,s={};return e.records.forEach(l=>{if(l.name){if(a+=1,s.hasOwnProperty(l.name))throw i().show(l.name+"已存在, 请调整分类名称",{color:"red"}),new Error("已存在");s[l.name]=!0}}),a<1?(i().show("至少设置1个产品分类",{color:"red"}),Promise.reject(!1)):P(e.type,e.records)}).then(r=>{r.data&&r.data.code===200&&i().show("保存成功")}).finally(()=>{e.loading=!1})},f=()=>{j(e.type).then(r=>{if(r.data&&r.data.code===200){e.records=r.data.data;for(let a=e.records.length;a<e.maxCounts;++a)e.records.push({name:""})}}).catch(r=>{console.error(r)})};return h(()=>{f()}),(r,a)=>(n(),u(E,{loading:e.loading,"max-width":"1000"},{default:t(()=>[o(y,{class:"bg-info"},{default:t(()=>[o(x,{icon:"mdi-shape-plus-outline",size:"small",class:"mr-1"}),a[0]||(a[0]=d(" 产品分类列表 "))]),_:1,__:[0]}),o(C,{class:"bg-grey-lighten-2 py-2"},{default:t(()=>a[1]||(a[1]=[d(" 设置产品中心的所有分类 ")])),_:1,__:[1]}),o(w,null,{default:t(()=>[o(z,{ref_key:"refForm",ref:m},{default:t(()=>[o(v,{dense:""},{default:t(()=>[(n(!0),b(k,null,S(e.records,(s,l)=>(n(),u(F,{cols:"4",lg:"4",md:"6",sm:"6",xs:"12"},{default:t(()=>[o(N,{modelValue:s.name,"onUpdate:modelValue":g=>s.name=g,label:`产品分类${l+1}`,"prepend-inner-icon":"mdi-shape-outline",clearable:""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),256))]),_:1})]),_:1},512)]),_:1}),o(B,null,{default:t(()=>[o(T,{loading:e.loading,variant:"elevated",color:"primary",onClick:c},{default:t(()=>a[2]||(a[2]=[d("保存")])),_:1,__:[2]},8,["loading"])]),_:1})]),_:1},8,["loading"]))}});export{O as default};
